import { DIPPRDensityProps } from '../interfaces/utils';

export const DIPPRDensityDictionary: Record<string, DIPPRDensityProps> = {
  Acetaldehyde: {
    name: 'Acetaldehyde',
    formula: 'C2H4O',
    CAS: '75-07-0',
    molecularWeight: 44.05256,
    C1: 1.711365,
    C2: 0.26355,
    C3: 466,
    C4: 0.28571,
    minimumTemperature: 149.78,
    maximumTemperature: 466,
    densityAtMinimumTemperature: 21.423,
    densityAtMaximumTemperature: 6.4935,
  },

  '1Butanol': {
    name: '1-Butanol',
    formula: 'C4H10O',
    CAS: '71-36-3',
    molecularWeight: 74.1216,
    C1: 0.98279,
    C2: 0.2683,
    C3: 563.1,
    C4: 0.25488,
    minimumTemperature: 183.85,
    maximumTemperature: 563.1,
    densityAtMinimumTemperature: 12.035,
    densityAtMaximumTemperature: 3.663,
  },

  '2Butanol': {
    name: '2-Butanol',
    formula: 'C4H10O',
    CAS: '78-92-2',
    molecularWeight: 74.1216,
    C1: 0.97552,
    C2: 0.26339,
    C3: 535.9,
    C4: 0.26864,
    minimumTemperature: 158.45,
    maximumTemperature: 535.9,
    densityAtMinimumTemperature: 12.473,
    densityAtMaximumTemperature: 3.7037,
  },

  '1Butene': {
    name: '1-Butene',
    formula: 'C4H8',
    CAS: '106-98-9',
    molecularWeight: 56.10632,
    C1: 1.0877,
    C2: 0.26454,
    C3: 419.5,
    C4: 0.2843,
    minimumTemperature: 87.8,
    maximumTemperature: 419.5,
    densityAtMinimumTemperature: 14.264,
    densityAtMaximumTemperature: 4.1117,
  },

  cis2Butene: {
    name: 'cis-2-Butene',
    formula: 'C4H8',
    CAS: '590-18-1',
    molecularWeight: 56.10632,
    C1: 1.1591,
    C2: 0.27085,
    C3: 435.5,
    C4: 0.28116,
    minimumTemperature: 134.26,
    maximumTemperature: 435.5,
    densityAtMinimumTemperature: 13.894,
    densityAtMaximumTemperature: 4.2795,
  },

  trans2Butene: {
    name: 'trans-2-Butene',
    formula: 'C4H8',
    CAS: '624-64-6',
    molecularWeight: 56.10632,
    C1: 1.1448,
    C2: 0.27154,
    C3: 428.6,
    C4: 0.28419,
    minimumTemperature: 167.62,
    maximumTemperature: 428.6,
    densityAtMinimumTemperature: 13.08,
    densityAtMaximumTemperature: 4.216,
  },

  ButylAcetate: {
    name: 'Butyl acetate',
    formula: 'C6H12O2',
    CAS: '123-86-4',
    molecularWeight: 116.15828,
    C1: 0.67794,
    C2: 0.2637,
    C3: 575.4,
    C4: 0.29318,
    minimumTemperature: 199.65,
    maximumTemperature: 575.4,
    densityAtMinimumTemperature: 8.3365,
    densityAtMaximumTemperature: 2.5709,
  },

  Butylbenzene: {
    name: 'Butylbenzene',
    formula: 'C10H14',
    CAS: '104-51-8',
    molecularWeight: 134.21816,
    C1: 0.50812,
    C2: 0.25238,
    C3: 660.5,
    C4: 0.29373,
    minimumTemperature: 185.3,
    maximumTemperature: 660.5,
    densityAtMinimumTemperature: 7.0264,
    densityAtMaximumTemperature: 2.0133,
  },

  ButylMercaptan: {
    name: 'Butyl mercaptan',
    formula: 'C4H10S',
    CAS: '109-79-5',
    molecularWeight: 90.1872,
    C1: 0.89458,
    C2: 0.27463,
    C3: 570.1,
    C4: 0.28512,
    minimumTemperature: 157.46,
    maximumTemperature: 570.1,
    densityAtMinimumTemperature: 10.585,
    densityAtMaximumTemperature: 3.2574,
  },

  secButylMercaptan: {
    name: 'sec-Butyl mercaptan',
    formula: 'C4H10S',
    CAS: '513-53-1',
    molecularWeight: 90.1872,
    C1: 0.89137,
    C2: 0.27365,
    C3: 554,
    C4: 0.2953,
    minimumTemperature: 133.02,
    maximumTemperature: 554,
    densityAtMinimumTemperature: 10.761,
    densityAtMaximumTemperature: 3.2573,
  },

  '1Butyne': {
    name: '1-Butyne',
    formula: 'C4H6',
    CAS: '107-00-6',
    molecularWeight: 54.09044,
    C1: 1.3409,
    C2: 0.27892,
    C3: 440,
    C4: 0.29661,
    minimumTemperature: 147.43,
    maximumTemperature: 440,
    densityAtMinimumTemperature: 14.901,
    densityAtMaximumTemperature: 4.8075,
  },

  Butyraldehyde: {
    name: 'Butyraldehyde',
    formula: 'C4H8O',
    CAS: '123-72-8',
    molecularWeight: 72.10572,
    C1: 1.033873,
    C2: 0.266739,
    C3: 537.2,
    C4: 0.28571,
    minimumTemperature: 176.8,
    maximumTemperature: 537.2,
    densityAtMinimumTemperature: 12.602,
    densityAtMaximumTemperature: 3.876,
  },

  ButyricAcid: {
    name: 'Butyric acid',
    formula: 'C4H8O2',
    CAS: '107-92-6',
    molecularWeight: 88.1051,
    C1: 0.88443,
    C2: 0.25828,
    C3: 615.7,
    C4: 0.248,
    minimumTemperature: 267.95,
    maximumTemperature: 615.7,
    densityAtMinimumTemperature: 11.087,
    densityAtMaximumTemperature: 3.4243,
  },

  Butyronitrile: {
    name: 'Butyronitrile',
    formula: 'C4H7N',
    CAS: '109-74-0',
    molecularWeight: 69.1051,
    C1: 0.79716,
    C2: 0.23168,
    C3: 585.4,
    C4: 0.28071,
    minimumTemperature: 161.3,
    maximumTemperature: 585.4,
    densityAtMinimumTemperature: 13.087,
    densityAtMaximumTemperature: 3.4408,
  },

  CarbonDioxide: {
    name: 'Carbon dioxide',
    formula: 'CO2',
    CAS: '124-38-9',
    molecularWeight: 44.0095,
    C1: 2.768,
    C2: 0.26212,
    C3: 304.21,
    C4: 0.2908,
    minimumTemperature: 216.58,
    maximumTemperature: 304.21,
    densityAtMinimumTemperature: 26.828,
    densityAtMaximumTemperature: 10.56,
  },

  CarbonDisulfide: {
    name: 'Carbon disulfide',
    formula: 'CS2',
    CAS: '75-15-0',
    molecularWeight: 76.1407,
    C1: 1.7968,
    C2: 0.28749,
    C3: 552,
    C4: 0.3226,
    minimumTemperature: 161.11,
    maximumTemperature: 552,
    densityAtMinimumTemperature: 19.064,
    densityAtMaximumTemperature: 6.25,
  },

  CarbonMonoxide: {
    name: 'Carbon monoxide',
    formula: 'CO',
    CAS: '630-08-0',
    molecularWeight: 28.0101,
    C1: 2.897,
    C2: 0.27532,
    C3: 132.92,
    C4: 0.2813,
    minimumTemperature: 68.15,
    maximumTemperature: 132.92,
    densityAtMinimumTemperature: 30.18,
    densityAtMaximumTemperature: 10.522,
  },

  CarbonTetrachloride: {
    name: 'Carbon tetrachloride',
    formula: 'CCl4',
    CAS: '56-23-5',
    molecularWeight: 153.8227,
    C1: 0.99835,
    C2: 0.274,
    C3: 556.35,
    C4: 0.287,
    minimumTemperature: 250.33,
    maximumTemperature: 556.35,
    densityAtMinimumTemperature: 10.843,
    densityAtMaximumTemperature: 3.6436,
  },

  CarbonTetrafluoride: {
    name: 'Carbon tetrafluoride',
    formula: 'CF4',
    CAS: '75-73-0',
    molecularWeight: 88.0043,
    C1: 1.955,
    C2: 0.27884,
    C3: 227.51,
    C4: 0.28571,
    minimumTemperature: 89.56,
    maximumTemperature: 227.51,
    densityAtMinimumTemperature: 21.211,
    densityAtMaximumTemperature: 7.0112,
  },

  Chlorine: {
    name: 'Chlorine',
    formula: 'Cl2',
    CAS: '7782-50-5',
    molecularWeight: 70.906,
    C1: 2.23,
    C2: 0.27645,
    C3: 417.15,
    C4: 0.2926,
    minimumTemperature: 172.12,
    maximumTemperature: 417.15,
    densityAtMinimumTemperature: 24.242,
    densityAtMaximumTemperature: 8.0666,
  },

  oTerphenyl: {
    name: 'o-Terphenyl',
    formula: 'C18H14',
    CAS: '84-15-1',
    molecularWeight: 230.30376,
    C1: 5.7136,
    C2: -0.003474,
    C3: NaN,
    C4: NaN,
    minimumTemperature: 288.15,
    maximumTemperature: 313.19,
    densityAtMinimumTemperature: 4.7126,
    densityAtMaximumTemperature: 4.6256,
  },
  oTerphenylExtended: {
    name: 'o-Terphenyl',
    formula: 'C18H14',
    CAS: '84-15-1',
    molecularWeight: 230.30376,
    C1: 0.3448,
    C2: 0.25116,
    C3: 857,
    C4: 0.29268,
    minimumTemperature: 329.35,
    maximumTemperature: 857.0,
    densityAtMinimumTemperature: 4.5526,
    densityAtMaximumTemperature: 1.3728,
  },
  Water: {
    name: 'Water',
    formula: 'H2O',
    CAS: '7732-18-5',
    molecularWeight: 18.01528,
    C1: -13.851,
    C2: 0.64038,
    C3: -0.0019124,
    C4: 1.8211e-6,
    minimumTemperature: 273.16,
    maximumTemperature: 353.15,
    densityAtMinimumTemperature: 55.497,
    densityAtMaximumTemperature: 54.001,
  },
  WaterExtended: {
    name: 'Water',
    formula: 'H2O',
    CAS: '7732-18-5',
    molecularWeight: 18.01528,
    C1: 17.874,
    C2: 35.618,
    C3: 19.655,
    C4: -9.1306,
    C5: -31.367,
    C6: -813.56,
    C7: -17421000,
    minimumTemperature: 273.16,
    maximumTemperature: 647.096,
    densityAtMinimumTemperature: 55.487,
    densityAtMaximumTemperature: 17.874,
  },
};

function calculateDIPPRDensityForOTerphenyl(temperature: number): number {
  const densityProps = DIPPRDensityDictionary['oTerphenyl'];
  const densityPropsExtended = DIPPRDensityDictionary['oTerphenylExtended'];
  let density = NaN;
  if (
    temperature >= densityProps.minimumTemperature &&
    temperature <= densityProps.maximumTemperature
  ) {
    density = densityProps.C1 + densityProps.C2 * temperature;
  } else if (
    temperature >= densityPropsExtended.minimumTemperature &&
    temperature <= densityPropsExtended.maximumTemperature
  ) {
    const exponent =
      1 +
      Math.pow(
        1 - temperature / densityPropsExtended.C3,
        densityPropsExtended.C4
      );
    density =
      densityPropsExtended.C1 / Math.pow(densityPropsExtended.C2, exponent);
  }
  return density;
}

function calculateDIPPRDensityForWater(temperature: number): number {
  const densityProps = DIPPRDensityDictionary['Water'];
  const densityPropsExtended = DIPPRDensityDictionary['WaterExtended'];
  let density = NaN;
  if (
    temperature >= densityProps.minimumTemperature &&
    temperature <= densityProps.maximumTemperature
  ) {
    density =
      densityProps.C1 +
      densityProps.C2 * temperature +
      densityProps.C3 * Math.pow(temperature, 2) +
      densityProps.C4 * Math.pow(temperature, 3);
  } else if (
    temperature >= densityPropsExtended.minimumTemperature &&
    temperature < densityPropsExtended.maximumTemperature
  ) {
    const criticalTemperature = 647.096;
    const tau = 1 - temperature / criticalTemperature;
    density =
      densityProps.C1 +
      densityProps.C2 * Math.pow(tau, 1 / 3) +
      densityProps.C3 * Math.pow(tau, 2 / 3) +
      densityProps.C4 * Math.pow(tau, 5 / 3) +
      (densityProps.C5 as number) * Math.pow(tau, 16 / 3) +
      (densityProps.C6 as number) * Math.pow(tau, 43 / 3) +
      (densityProps.C7 as number) * Math.pow(tau, 110 / 3);
  } else if (
    Math.abs(temperature - densityPropsExtended.maximumTemperature) < 1e-4
  ) {
    density = densityPropsExtended.densityAtMaximumTemperature;
  }
  return density;
}

export function calculateDIPPRDensity(
  compound: string,
  temperature: number
): number {
  const densityProps: DIPPRDensityProps | undefined =
    DIPPRDensityDictionary[compound];
  let density = NaN;
  if (compound === 'Water') {
    density = calculateDIPPRDensityForWater(temperature);
  } else if (compound === 'oTerphenyl') {
    density = calculateDIPPRDensityForOTerphenyl(temperature);
  } else if (
    densityProps !== undefined &&
    temperature >= densityProps.minimumTemperature &&
    temperature <= densityProps.maximumTemperature
  ) {
    const exponent =
      1 + Math.pow(1 - temperature / densityProps.C3, densityProps.C4);
    density = densityProps.C1 / Math.pow(densityProps.C2, exponent);
  }
  return density;
}
